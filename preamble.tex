\documentclass[a4paper,10pt,twoside,openright]{book}

\bibliographystyle{plain}

\usepackage{hyperref}
\usepackage{xspace}
\usepackage{todonotes}
\usepackage{amsmath,amsthm,amssymb,stmaryrd}
\usepackage{cleveref} % load cleveref /after/ amsthm to distinguish between different theorem headings
\usepackage{bbold} % for blackboard bold numeral 1
\usepackage{url}
\usepackage[pdftex, all]{xy}
\usepackage{environ} % for data type decl environment, since align* doesn't play nice with newenvironment
\usepackage{xifthen} % for data type decl hackery, detect empty parameters
\usepackage{graphicx} % for \naturalto hackery

% TODOs
\newcommand{\todoi}[1]{\todo[inline]{#1}}

\newcommand{\eg}{e.g.\xspace}
\newcommand{\ie}{i.e.\xspace}

\newcommand{\from}{\leftarrow}

% Propositions, theorems, corollaries, etc.
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% Agda-style syntax highlighting
\newcommand{\AgdaKeyword}[1]{\textcolor[HTML]{CD6600}{\mathbf{#1}}}
\newcommand{\AgdaDatatype}[1]{\textcolor[HTML]{0033CD}{#1}}
\newcommand{\AgdaInductiveConstructor}[1]{\textcolor[HTML]{008B00}{#1}}
\newcommand{\AgdaPrimitiveType}[1]{\textcolor[HTML]{0000CD}{#1}}
\newcommand{\AgdaFunction}[1]{\textcolor[HTML]{0000CD}{#1}}

\newcommand{\AgdaPragma}[1]{\mathsf{\{-\#\ #1\ \#-\}}}

% Keywords
\newcommand{\data}{\AgdaKeyword{data}}
\newcommand{\where}{\AgdaKeyword{where}}
\newcommand{\postulate}{\AgdaKeyword{postulate}}

% Primitives
\newcommand{\emptyty}{\AgdaPrimitiveType{0}}
\newcommand{\unitty}{\AgdaPrimitiveType{1}}
\newcommand{\unitval}{\AgdaFunction{\mathsf{tt}}}

\newcommand{\initty}{\AgdaPrimitiveType{0}}

% Identity types
\newcommand{\refl}{\AgdaInductiveConstructor{\mathsf{refl}}}
\newcommand{\J}{\AgdaFunction{\mathsf{J}}}
\newcommand{\sym}[1]{#1\AgdaFunction{^{-1}}}

% Universes
\newcommand{\Set}{\AgdaPrimitiveType{\mathsf{Set}}}
\newcommand{\Type}{\AgdaPrimitiveType{\mathsf{Type}}}
\newcommand{\Prop}{\AgdaPrimitiveType{\mathsf{Prop}}}
\newcommand{\Fam}{\AgdaFunction{\mathsf{Fam}}}
\newcommand{\Rel}{\AgdaFunction{\mathsf{Rel}}}

\newcommand{\isset}{\AgdaFunction{\mathsf{is-set}}}
\newcommand{\isprop}{\AgdaFunction{\mathsf{is-prop}}}

% Equational reasoning
\newcommand{\reasontext}[1]{\{\ \textsf{#1}\ \}}

% Data type declaration environment and commands
\newcommand{\sortname}[1]{&\data\ #1}
\newcommand{\sortnamety}[2]{\sortname{#1} : #2}
\newcommand{\functy}[2]{&#1 : #2}
\newcommand{\constr}[2]{&\ \ \ \ #1 : #2}
\newcommand{\constrdots}{&\ \ \ \ \ \ \vdots}

\NewEnviron{datatype}[2]{%
  \begin{align*}
    \ifthenelse{\equal{#2}{}}{\sortname{#1}}{\sortnamety{#1}{#2}}\ \where \\
    \BODY
  \end{align*}}

\NewEnviron{sorts}{%
  \begin{align*}
    \BODY
  \end{align*}}

% Logical equivalence
\newcommand{\logequiv}{\leftrightarrow}

% Equality and its operations
\newcommand{\pathover}[4]{#3 =^{#1}_{#2} #4}
\newcommand{\ap}{\AgdaFunction{\mathsf{ap}}}
\newcommand{\apd}{\AgdaFunction{\mathsf{apd}}}
\newcommand{\transport}{\AgdaFunction{\mathsf{transport}}}
\newcommand{\defeq}{\equiv}
\newcommand{\ddefeq}{:\defeq}

% is-prop, is-equiv, etc.
\newcommand{\isequiv}{\AgdaFunction{\mathsf{is-equiv}}}

% Naturals
\newcommand{\natty}{\AgdaDatatype{\mathbb{N}}}
\newcommand{\natzero}{\AgdaInductiveConstructor{\mathsf{zero}}}
\newcommand{\natsucc}{\AgdaInductiveConstructor{\mathsf{succ}}}

\newcommand{\natrec}{\AgdaFunction{\mathbb{N}\mathsf{-rec}}}

% Interval type
\newcommand{\intty}{\AgdaDatatype{\mathsf{I}}}
\newcommand{\intzero}{\AgdaInductiveConstructor{\mathsf{zero}}}
\newcommand{\intone}{\AgdaInductiveConstructor{\mathsf{one}}}
\newcommand{\intseg}{\AgdaInductiveConstructor{\mathsf{seg}}}

\newcommand{\intrec}{\AgdaFunction{\mathsf{I-rec}}}
\newcommand{\intrecbetazero}{\AgdaFunction{\mathsf{I-rec-\beta}}_{\intzero}}
\newcommand{\intrecbetaone}{\AgdaFunction{\mathsf{I-rec-\beta}}_{\intone}}
\newcommand{\intrecbetaseg}{\AgdaFunction{\mathsf{I-rec-\beta}}_{\intseg}}

\newcommand{\intind}{\AgdaFunction{\mathsf{I-ind}}}

% Quotient type
\newcommand{\quotty}[2]{#1 \AgdaDatatype{/} #2}
\newcommand{\quotproj}[1]{\AgdaInductiveConstructor{[}\,#1\,\AgdaInductiveConstructor{]}}
\newcommand{\quoteq}{\AgdaInductiveConstructor{q}}

\newcommand{\quotind}[2]{\AgdaFunction{\mathsf{#1 / #2 -ind}}}

% Coequaliser
\newcommand{\coeqty}[2]{\AgdaDatatype{\mathsf{coeq}}_{#1, #2}}
\newcommand{\coeqproj}{\AgdaInductiveConstructor{c}}
\newcommand{\coeqeq}{\AgdaInductiveConstructor{\mathsf{eq}}}

\newcommand{\coeqind}[2]{\AgdaDatatype{\mathsf{coeq}}\ #1\ #2 -ind}

% Infinitely branching tree
\newcommand{\treety}{\AgdaDatatype{\mathsf{Tree}}}
\newcommand{\treeleaf}{\AgdaInductiveConstructor{\mathsf{leaf}}}
\newcommand{\treenode}{\AgdaInductiveConstructor{\mathsf{node}}}
\newcommand{\treeperm}{\AgdaInductiveConstructor{\mathsf{perm}}}

\newcommand{\pretreety}{\AgdaDatatype{\mathsf{Tree}_0}}
\newcommand{\pretreeleaf}{\AgdaInductiveConstructor{\mathsf{leaf}_0}}
\newcommand{\pretreenode}{\AgdaInductiveConstructor{\mathsf{node}_0}}

\newcommand{\treerel}{\sim}
\newcommand{\treerelty}[2]{#1 \AgdaDatatype{\treerel} #2}
\newcommand{\treerelnode}{\AgdaInductiveConstructor{\mathsf{rel-node}}}

% Syntax of type theory
\newcommand{\ttconty}{\AgdaDatatype{\mathsf{Con}}}
\newcommand{\tttyty}{\AgdaDatatype{\mathsf{Ty}}}

\newcommand{\ttnil}{\AgdaInductiveConstructor{\epsilon}}
\newcommand{\ttcons}[2]{#1 \AgdaInductiveConstructor{,} #2}

\newcommand{\ttzero}{\AgdaInductiveConstructor{`0}}
\newcommand{\ttone}{\AgdaInductiveConstructor{`1}}
\newcommand{\ttpi}{\AgdaInductiveConstructor{`\Pi}}

\newcommand{\tttmty}{\AgdaDatatype{\mathsf{Tm}}}
\newcommand{\ttapp}{\AgdaInductiveConstructor{\mathsf{app}}}
\newcommand{\ttlam}{\AgdaInductiveConstructor{\mathsf{lam}}}

\newcommand{\ttconind}{\AgdaFunction{\mathsf{ind}}_{\ttconty}}
\newcommand{\tttyind}{\AgdaFunction{\mathsf{ind}}_{\tttyty}}

% Arbitrary inductive type T
\newcommand{\Tty}{\AgdaDatatype{T}}
\newcommand{\Ta}{\AgdaInductiveConstructor{a}}
\newcommand{\Tb}{\AgdaInductiveConstructor{b}}

% Families
\newcommand{\total}{\AgdaFunction{\mathsf{total}}}
\newcommand{\proj}{\AgdaFunction{\mathsf{proj}}}
\newcommand{\preimage}{\AgdaFunction{\mathsf{preimage}}}
\newcommand{\DepHom}{\AgdaFunction{\mathsf{DepHom}}}
\newcommand{\Sect}{\AgdaFunction{\mathsf{Sect}}}
\newcommand{\grph}{\AgdaFunction{\mathsf{graph}}}
\newcommand{\snd}{\AgdaFunction{\mathsf{snd}}}

% Categories
% From: http://tex.stackexchange.com/questions/140978/arrow-accented-with-a-dot-natural-transformation
\newcommand{\naturalto}{%
  \mathrel{\vbox{\offinterlineskip
    \mathsurround=0pt
    \ialign{\hfil##\hfil\cr
      \normalfont\scalebox{1.2}{.}\cr
      $\rightarrow$\cr}
  }}%
}

\newcommand{\inftycat}{$(\omega,1)$-category\xspace}
\newcommand{\inftycats}{$(\omega,1)$-categories\xspace}
\newcommand{\Cat}{\AgdaPrimitiveType{\mathsf{Cat}}}
\newcommand{\Aa}{\mathcal{A}}
\newcommand{\Cc}{\mathcal{C}}
\newcommand{\Dd}{\mathcal{D}}
\newcommand{\id}{\mathsf{id}}
\newcommand{\algcat}[1]{#1\mathsf{-alg}}
\newcommand{\dialgcat}[2]{(#1,#2)\mathsf{-dialg}}
\newcommand{\monalgcat}[1]{#1\mathsf{-Alg}}
\newcommand{\termcat}{\mathbb{1}}
\newcommand{\Func}[2]{#1 \Rightarrow #2}
\newcommand{\Nat}[2]{#1 \naturalto #2}
\newcommand{\Iso}[2]{#1 \simeq #2}
\newcommand{\initobj}{\emptyset}
\newcommand{\termobj}{1}
\newcommand{\inithom}{!}
\newcommand{\termhom}{!`}

% Coherence
\newcommand{\leftid}{\mathsf{left-id}}
\newcommand{\rightid}{\mathsf{right-id}}
\newcommand{\assoc}{\mathsf{assoc}}

% Functor coherence
\newcommand{\Fid}{F\mathsf{-id}}
\newcommand{\Fcomp}{F\mathsf{-}\circ}
\newcommand{\Fleftid}{F\mathsf{-left-id}}
\newcommand{\Fassoc}{F\mathsf{-assoc}}
\newcommand{\Gid}{G\mathsf{-id}}
\newcommand{\Gcomp}{G\mathsf{-}\circ}
\newcommand{\Gleftid}{G\mathsf{-left-id}}
\newcommand{\Gassoc}{G\mathsf{-assoc}}


% Sorts
\newcommand{\sortsty}{\AgdaDatatype{\mathsf{Sorts}}}
\newcommand{\Ss}{\mathcal{S}}
\newcommand{\SortCat}[1]{\AgdaFunction{\llbracket}\ #1\ \AgdaFunction{\rrbracket}}
\newcommand{\sortsnil}{\AgdaInductiveConstructor{\mathsf{nil}}}
\newcommand{\sortssnoc}{\AgdaInductiveConstructor{\mathsf{snoc}}}

% Sort membership
\newcommand{\sortsin}[2]{#1\ \AgdaDatatype{\in}\ #2}
\newcommand{\sortsinhere}{\AgdaInductiveConstructor{\mathsf{here}}}
\newcommand{\sortsinthere}{\AgdaInductiveConstructor{\mathsf{there}}}

% Spec
\newcommand{\specty}{\AgdaDatatype{\mathsf{Spec}}}
\newcommand{\specnil}{\AgdaInductiveConstructor{\mathsf{nil}}}
\newcommand{\specsnoc}{\AgdaInductiveConstructor{\mathsf{snoc}}}
\newcommand{\Alg}{\AgdaFunction{\mathsf{Alg}}}
\newcommand{\Und}{\AgdaFunction{\mathsf{U}}}
\newcommand{\Constr}{\AgdaFunction{\mathsf{Constr}}}

\newcommand{\specaltty}{\AgdaDatatype{\mathsf{Spec'}}}
\newcommand{\specaltiscorrect}{\AgdaFunction{\mathsf{is-correct}}}
\newcommand{\specaltnil}{\AgdaInductiveConstructor{\mathsf{nil}}}
\newcommand{\specaltsnoc}{\AgdaInductiveConstructor{\mathsf{snoc}}}
\newcommand{\Algalt}{\AgdaFunction{\mathsf{Alg'}}}
\newcommand{\Undalt}{\AgdaFunction{\mathsf{U'}}}

% Containers
\newcommand{\cont}[2]{#1 \lhd #2}
\newcommand{\context}[1]{\llbracket #1 \rrbracket}

% Rel-sorted example inductive type (A,B) and general arbitrary
% inductive type A
\newcommand{\Aty}{\AgdaDatatype{A}}
\newcommand{\Ac}{\AgdaInductiveConstructor{c}}
\newcommand{\Aco}{\AgdaInductiveConstructor{c_0}}
\newcommand{\Aci}{\AgdaInductiveConstructor{c_1}}
\newcommand{\Acii}{\AgdaInductiveConstructor{c_2}}
\newcommand{\Ack}{\AgdaInductiveConstructor{c_k}}

\newcommand{\Bty}{\AgdaDatatype{B}}
\newcommand{\Bci}{\AgdaInductiveConstructor{c_1}}
\newcommand{\Bcii}{\AgdaInductiveConstructor{c_2}}
\newcommand{\Bciii}{\AgdaInductiveConstructor{c_3}}

\newcommand{\Arec}{\AgdaFunction{A\mathsf{-rec}}}

% Real numbers
\newcommand{\realty}{\AgdaDatatype{\mathbb{R}}}
\newcommand{\realrel}[2]{#1 \AgdaDatatype{\sim} #2}

% Field
\newcommand{\fieldty}{\AgdaDatatype{\mathsf{Field}}}
\newcommand{\fieldinv}{\AgdaInductiveConstructor{\mathsf{inv}}}
\newcommand{\fieldzero}{\AgdaInductiveConstructor{0}}

% Free monad
\newcommand{\Fstareta}{\AgdaInductiveConstructor{\eta}}
\newcommand{\Fstarc}{\AgdaInductiveConstructor{c}}

\newcommand{\List}{\AgdaDatatype{\mathsf{List}}}
