\chapter{Constructing quotient inductive-inductive definitions}
\label{constructing}

We have given a formal definition of what constitutes a quotient
inductive-inductive definition in terms of algebraic semantics. We
have shown that the resulting categories of algebras are sensible in
the sense that an algebra is initial if and only if it satisfies the
induction principle. We have therefore shown that the initial algebras
are well-behaved in this regard. To justify adding quotient
inductive-inductive types to the theory, we still need to establish
their existence in the usual models. After all, these results are all
uninteresting if these models do not have quotient inductive-inductive
types, which would make our results vacuously true.

To start out we will address the issue of strict positivity in
inductive definitions and see how we can generalise the notion of
\emph{container} to fit our needs. In this light, we will examine what
the associated generalisation of W-types would be for our inductive
definitions.

Starting from a more semantic point of view, we discuss in
\cref{sequential-colimits} the usual construction of initial algebras
for an endofunctor as a sequential colimit. We explore how this
approach can be both internalised as well as adapted to construct
initial algebras for certain classes of quotient inductive-inductive
definitions. They key is here to not only construct an initial object
but establish that there is a left adjoint to the forgetful functor
$\Func{\Alg_{n+1}}{\Alg_{n}}$, which allows us to do the construction
by induction on the length of the specification. We end up with a
chain of adjunctions:
$$
\xymatrix{
\SET \ar@/^/[r]^{L_0}
\ar@{}[r]|{\top} 
&\Alg_0 \ar@/^/[l]^{U_0} \ar@/^/[r]^{L_1} 
\ar@{}[r]|{\top} 
&\Alg_1 \ar@/^/[l]^{U_1} \ar@/^/[r]^{L_2} 
\ar@{}[r]|{\top} 
&\hdots \ar@/^/[l]^{U_2} \ar@/^/[r]^{L_n} 
\ar@{}[r]|{\top} 
&\Alg_n \ar@/^/[l]^{U_n}
}
$$
Since left adjoints preserve colimits, in particular initial objects
and $\SET$ has an initial object $\emptyty$,
$(L_n \circ \hdots \circ L_0)\ \emptyty$ gives us the initial algebra
in $\Alg_n$ we are after.

\section{Strict positivity}

For ordinary inductive types we have to have several syntactic
restrictions on the point constructors in order for the inductive
types to actually exist. We have seen in
\cref{positivity} that the recursive positions may only
occur in \emph{positive positions} in order for the arguments to
describe a covariant functor. This is not enough to guarantee the
existence of an initial algebra. If we look at $\SET$ and consider the
double powerset functor $P : \Func{\SET}{\SET}$:
$$
P\ X \ddefeq (X \to \boolty) \to \boolty
$$
This defines a covariant functor on $\SET$, yet $\algcat{P}$ does not
have an initial algebra. By Lambek's lemma, having an initial algebra
$(X,\theta) : | \algcat{P} |$ would imply that $\Iso{X}{P\ X}$. By
Cantor's theorem, we know that there is no set $X$ which is isomorphic
to its powerset, hence we arrive at a contradiction.

\section{Initial objects in sort categories}

If we have an inductive specification with no constructors, the
category of algebras is the category of sorts. Constructing the
initial object in these categories is similar to the construction in
$\FAM$. We will construct the left adjoint to the forgetful functors
of sort categories, similar to that of $\FAM$. The forgetful functor
$\Func{\FAM}{\SET}$ has a left adjoint: the \emph{truth functor} that
maps a set $X$ to the family $\lambda x . \unitty : X \to \Set$. This
generalises to any functor in the abovementioned chain of sort
categories: suppose we have a sort specification $\Ss : \sortsty$
giving rise to the following chain of sort categories:
$$
\xymatrix{
\termcat &S_0 \ar[l]_{t_0} &S_1 \ar[l]_{t_1} &\hdots \ar[l]_{t_2} &S_n \ar[l]_{t_n}
}
$$

\begin{proposition}
Every forgetful functor $t_i : \Func{S_{i+1}}{S_i}$ has a left adjoint
\end{proposition}

\begin{proof}
  We define the functor $u_i : \Func{S_i}{S_{i+1}}$ as follows:
  \begin{itemize}
  \item on objects: $u_i X \ddefeq (X , \lambda x . \unitty)$
  \item on morphisms: $u_i f \ddefeq (f , \lambda a\ x . x)$
  \end{itemize}
  We then have to check whether we have for any $X : | S_i |$ and
  $(Y,Q) : | S_{i+1} |$ that
  $$
  S_{i+1}(u_i\ X , (Y,Q)) = S_i(X,Y)
  $$
  which we can show by simple equational reasoning:
  \begin{align*}
      &&S_{i+1}(u_i\ X , (Y,Q)) \\
    &=& S_{i+1}((X,\lambda x . \unitty), (Y,Q)) \\
    &=& (f : S_i(X,Y) \times (g : (a : R_{i+1} X) \to \unitty \to \unitty) \\
    &=& S_i(X,Y)
  \end{align*}

\end{proof}

\begin{proposition}
  There exists an adjunction between $S_0$ and $\SET$
\end{proposition}

\begin{proof}
  Note that $S_0$ is equivalent to a category with objects
  $A \to \Set$ for some $A : \Set$ and morphisms between
  $P, Q : A \to \Set$ being dependent functions
  $(x : A) \to P\ x \to Q\ x$. Usually $A = \unitty$, so we have a
  trivial adjunction between $S_0$ and $\SET$. Whatever the choice of
  $A$ is, we can construct the following pair of adjoint functors
  between $\SET$ and $S_0$:
  \begin{align*}
    &\Pi : \Func{S_0}{\SET} \\
    &\Pi\ P \ddefeq (x : A) \to P\ x \\
    \\
    &K : \Func{\SET}{S_0} \\
    &K\ X \ddefeq (\lambda x . X)
  \end{align*}
  We then have for any $X : \Set$ and $P : A \to \Set$ the following equality
  \begin{align*}
  S_0(LX , P) &=& (x : A) \to X \to P\ x \\
    &=& X \to (x : A) \to P\ x \\
    &=& X \to \Pi\ P
  \end{align*}
  Therefore we have that $K \dashv \Pi$.
\end{proof}

We therefore get the following chain of adjunctions:
$$
\xymatrix{
\SET \ar@/^/[r]^{K}
\ar@{}[r]|{\top} 
&S_0 \ar@/^/[l]^{\Pi} \ar@/^/[r]^{u_1} 
\ar@{}[r]|{\top} 
&S_1 \ar@/^/[l]^{t_1} \ar@/^/[r]^{u_2} 
\ar@{}[r]|{\top} 
&\hdots \ar@/^/[l]^{t_2} \ar@/^/[r]^{u_n} 
\ar@{}[r]|{\top} 
&S_n \ar@/^/[l]^{t_n}
}
$$
Since $\SET$ has an initial object, we get the initial object of any
sort category $S_i$ by following the chain of left adjoints.

\section{Initial objects via sequential colimits}
\label{sequential-colimits}

Initial algebras of endofunctors can be constructed via sequential
colimits, given some reasonable assumptions on the endofunctor. In
this section we will review this result due to Ad\'amek
\cite{Adamek1979} and see how we can use it to construct initial
dialgebras. We will also discuss how these proofs can be performed
inside type theory itself.

\begin{definition}[$\omega$-cochain]
  An $\omega$-cochain in a category $\Cc$ consists of:
  \begin{itemize}
  \item $X : \natty \to | \Cc |$
  \item $x : (n : \natty) \to \Cc(X_n , X_{n+1})$
  \end{itemize}
  \ie, we have the following diagram:
  $$
  \xymatrix{
    X_0 \ar[r]^{x_0}
    &X_1 \ar[r]^{x_1}
    &X_2 \ar[r]^{x_2}
    &X_3 \ar[r]^{x_3}
    &X_4 \ar[r]^{x_4}
    &\hdots
  }
  $$
\end{definition}

\begin{definition}[Sequential colimit]
  Given an $\omega$-cochain $(X,x)$, the colimit of $(X,x)$ consists
  of:
  \begin{itemize}
  \item An object $X_\omega : | \Cc |$
  \item $c : (n : \natty) \to \Cc(X_n,X_\omega)$ its constructors
  \item $g : (n : \natty) \to c_n = c_{n+1} \circ x_n$
  \end{itemize}
  with satisfies the universal property that for any other cocone $(Y,d,h)$ we get:
  \begin{itemize}
  \item a unique $f : \Cc(X_\omega, Y)$
  \item with computation rule $f \circ c_n = d_n$
  \end{itemize}
\end{definition}

\begin{theorem}[Ad\'amek]
  \label{adamek-thm}
  Let $\Cc : \Cat$ be a category with an endofunctor
  $F : \Func{\Cc}{\Cc}$. The category of algebras $\algcat{F}$ has an
  initial object if $\Cc$ has sequential colimits and an initial
  object and $F$ preserves these colimits.
\end{theorem}

\begin{proof}
  Define $X_\omega$ as the colimit of the cochain:
  $$
  \xymatrix{
    \initobj \ar[r]^{\inithom} 
    &F\ \initobj \ar[r]^{F \inithom} 
    &F^2\ \initobj \ar[r]^{F^2 \inithom} 
    &F^3\ \initobj \ar[r]^{F^3 \inithom} 
    &F^4\ \initobj \ar[r] 
    &\hdots
  }
  $$
  We get the following:
  \begin{itemize}
  \item $c_n : \Cc(F^n \initobj , X_\omega)$
  \item $g_n : c_n = c_{n+1} \circ F^n \inithom$
  \end{itemize}
  along with the universal property giving us a recursion
  principle. Similarly for $F X_\omega$: since $F$ preserves
  sequential colimits, we have that $F X_\omega$ is the colimit of the
  cochain formed by applying $F$ to the one given above, hence we have:
  \begin{itemize}
  \item $F c_n : \Cc(F^{n+1} \initobj, F X_\omega)$
  \item $F g_n : c'_n = F c_n \circ F^{n+1} \inithom$
  \end{itemize}
  We can define the algebra structure on $X_\omega$ by employing the
  recursion principle of $F X_\omega$. We define $\theta$ to be the
  morphism with computation rule, for any $n : \natty$:
  $$
  \theta \circ F c_n = c_{n+1}
  $$
  
  Now that we have an algebra, we need to show that it is
  initial. Suppose $(Y,\rho)$ is an $F$-algebra, then we first show
  that we get an algebra morphism $(X_\omega , \theta) \to
  (Y,\rho)$.
  $Y$ comes equipped with a cocone by virtue of its algebra structure,
  defined as follows:
  $$
  \xymatrix{
    \initobj \ar[r]^{\inithom}
    \ar[d]_{\inithom}
    &F\ \initobj \ar[r]^{F \inithom} 
    \ar[d]_{F \inithom}
    &F^2\ \initobj \ar[r]^{F^2 \inithom} 
    \ar[d]_{F^2 \inithom}
    &F^3\ \initobj \ar[r]^{F^3 \inithom} 
    \ar[d]_{F^3 \inithom}
    &\hdots
    \\
    Y
    &F\ Y \ar[l]^{\rho} 
    &F^2\ Y \ar[l]^{F \rho} 
    &F^3\ Y \ar[l]^{F^2 \rho} 
    &\hdots \ar[l]^{F^3 \rho}  
  }
  $$
  We have the cocone $(Y,y_n)$ where $y_n$ is defined recursively:
  \begin{align*}
    &y : (n : \natty) \to \Cc(F^n \initobj, Y) \\
    &y\ 0 \ddefeq\ \inithom \\
    &y\ (n+1) \ddefeq \rho \circ F y_n
  \end{align*}
  It is immediate from this definition that we have
  $y_n = y_{n+1} \circ F^n \inithom$, hence $(Y,y_n)$ is indeed a
  cocone.

  We can now define $f : \Cc(X_\omega, Y)$ by recursion, satisfying
  the computation rule:
  $$
  f \circ c_n = y_n
  $$
  Now we need to establish whether $f \circ \theta = \rho \circ F
  f$.
  Both the left hand and right hand side are cocone morphisms
  $(F X_\omega , F c_n) \to (Y , y_n)$:
  \begin{align*}
    f \circ \theta \circ F c_n &=& f \circ c_{n+1} \\
    &=&y_{n+1}
  \end{align*}
  and
  \begin{align*}
    \rho \circ F f \circ F c_n &=& \rho \circ F (f \circ c_n) \\
    &=&\rho \circ F y_n \\
    &=&y_{n+1}
  \end{align*}
  By the universal property of $F X_\omega$ they are indeed equal. The
  same line of reasoning can be used to established that if we have
  another algebra morphism $f' : (X_\omega,\theta) \to (Y,\rho)$, then
  $f = f'$, which shows initiality of $(X_\omega,\theta)$.
\end{proof}

\subsection{Internal sequential colimits}

The definition of sequential colimits is presented in such a way that
we can straightforwardly formalise it in type theory. The same goes
for Ad\'amek's theorem. We can also show internally that $\SET$ has
sequential colimits, if we have an internal version of coequalisers at
hand.

\begin{proposition}
  We can construct sequential colimits in $\SET$ from the natural
  numbers and coequalisers.
\end{proposition}

\begin{proof}
  Suppose we have $X : \natty \to \Set$ with
  $x : (n : \natty) \to X_n \to X_{n+1}$. Define the function $f$:
  \begin{align*}
    &f : (n : \natty) \times X_n \to (n : \natty) \times X_n \\
    &f\ (n , a) \ddefeq (n + 1 , x_n\ a)
  \end{align*}
  We define $X_\omega$ to be the coequaliser:
  $$
  \xymatrix{
    (n : \natty) \times X_n
    \ar@<.5ex>[r]^{\id}
    \ar@<-.5ex>[r]_{f}
    &(n : \natty) \times X_n
    \ar[r]^-{c}
    &X_\omega
  }
  $$
  We therefore get for any $(n , a) : (n : \natty) \times X_n$:
  $$
  c\ (n , a) = c\ (n + 1 , x_n\ a)
  $$
  Hence we get a cocone for the $\omega$-cochain. Its universal
  property follows directly from the universal property of the
  coequaliser.
\end{proof}

We can generalise the result to arbitrary categories easily, but this
does not help us much as constructing coproducts in categories of
algebras is rather involved, and already involves sequential colimits
themselves.

\subsection{Constructing $\SET$-sorted quotient inductive-inductive definitions}

In this section we will look at the simplified setting of $\SET$-sorted quotient
inductive-inductive definitions. Our ultimate goal is to show that for
any $\SET$-sorted $s : \specty$, where all the functors preserve
sequential colimits, we have a left adjoint to the forgetful functor
$U : \Func{\Alg_s}{\SET}$. We can do this by induction on the
specification $s$. To construct this left adjoint for a category
$\Alg_s$ extended with a point or path constructor, we need to have
sequential colimits, coequalisers and binary coproducts in $\Alg_s$.

$\SET$ satisfies all these conditions, so the base case of the
induction holds. In the next two sections we will to the inductive
step for point and path constructors respectively.

\subsubsection{Point constructors}

If we have $\Alg_s$ with an adjunction
$L \dashv U : \Func{\Alg_s}{\SET}$ and a functor
$F : \Func{\Alg_s}{\SET}$, then the category of $(F,U)$-dialgebras is
equivalent to the category of $(L \circ F)$-algebras. As such, we can
focus our attention on the properties of categories of algebras of
endofunctors. Also note that since $L$ is a left adjoint, it preserves
colimits, hence $L \circ F$ also preserves sequential colimits.

It suffices to show that if a category $\Cc$ has sequential colimits,
binary coproducts and coequalisers and $F$ is an endofunctor on $\Cc$
preserving colimits, then $\algcat{F}$ also has sequential colimits,
binary coproducts and coequalisers and furthermore a left adjoint from
$\Cc$ to the forgetful functor.

In the following we will assume that $\Cc$ is a category with
sequential colimits, binary coproducts and coequalisers and that $F$
is an endofunctor on $\Cc$ preserving sequential colimits.

\begin{proposition}
  The category $\algcat{F}$ has sequential colimits.
\end{proposition}

\begin{proof}
  Suppose we have the following cochain in $\algcat{F}$:
  $$
  \xymatrix{
    (X_0,\theta_0) \ar[r]^{x_0}
    &(X_1,\theta_1) \ar[r]^{x_1} 
    &(X_2,\theta_1) \ar[r]^{x_2} 
    &(X_3,\theta_1) \ar[r]^{x_3}
    &(X_4,\theta_1) \ar[r]
    &\hdots
  }
  $$
  This means we have the following diagram in $\Cc$:
  $$
  \xymatrix{
    F X_0 \ar[r]^{F x_0} \ar[d]_{\theta_0}
    &F X_1 \ar[r]^{F x_1} \ar[d]_{\theta_1}
    &F X_2 \ar[r]^{F x_2} \ar[d]_{\theta_2}
    &F X_3 \ar[r]^{F x_3} \ar[d]_{\theta_3}
    &F X_4 \ar[r] \ar[d]_{\theta_4} 
    &\hdots
    \\
    X_0 \ar[r]_{x_0}
    &X_1 \ar[r]_{x_1}
    &X_2 \ar[r]_{x_2}
    &X_3 \ar[r]_{x_3}
    &X_4 \ar[r]
    &\hdots
  }
  $$
  To be precise, we have:
  \begin{itemize}
  \item $X : \natty \to | \Cc |$ with algebras $\theta : (n : \natty) \to \Cc(F X_n, X_n)$
  \item $x : (n : \natty) \to \Cc(X_n,X_{n+1})$ satisfying $x_n \circ \theta_n = \theta_{n+1} \circ Fx_n$
  \end{itemize}

  We can take the colimit of the cochain $(X,x)$ in $\Cc$ and we get
  $X_{\omega} : | \Cc |$ with
  $c : (n : \natty) \to \Cc(X_n,X_{\omega})$ satisfying
  $c_n = c_{n+1} \circ x_n$, satisfying the universal property of
  sequential colimits. Similarly, as $F$ preserves sequential
  colimits, we get that $FX_{\omega}$ with
  $Fc : (n : \natty) \to \Cc(FX_n,FX_{\omega})$ is a colimit of the
  cochain $(FX,Fx)$. This allows us to construct an algebra structure
  on $X_{\omega}$, which is the map $\theta_{\omega}$ defined by the
  computation property:
  $$
  \theta_{\omega} \circ Fc_n = c_n \circ \theta_n
  $$
  For this to work, we have to make sure that $c_n \circ \theta_n$
  does in fact form a cocone, \ie we need to check whether
  $c_n \circ \theta_n = c_{n+1} \circ \theta_{n+1} \circ Fx_n$. This
  follows from the fact that $X_{\omega}$ is a colimit of $(X,x)$,
  giving us $c_n = c_{n+1} \circ x_n$. Every $x_n$ is an algebra
  morphism: $x_n \circ \theta_n = \theta_{n+1} \circ Fx_n$, so we are
  done.

  By definition of $\theta_{\omega}$, every $c_n$ is an algebra
  morphism.

  Finally we have to check whether $(X_{\omega},\theta_{\omega})$
  satisfies the universal property. This follows from the universal
  property of $X_{\omega}$.
\end{proof}

\begin{proposition}
  \label{f-alg-coproducts}
  The category $\algcat{F}$ has binary coproducts.
\end{proposition}

\begin{proof}
  Let $(X,\theta),(Y,\rho) : | \algcat{F} |$. Observe that by
  assumption we have the coproduct $\coproduct{X}{Y}$ in $\Cc$, but there is no
  evidence that this will carry an algebra structure, let alone one
  such that the inclusions $X \to \coproduct{X}{Y}$ and $Y \to \coproduct{X}{Y}$ will
  preserve this structure.

  Instead, we will create a sequence of objects $A_n$ in $\Cc$, which
  have an approximate algebra structure (a map
  $\alpha_n : FA_n \to A_{n+1}$). For every $A_n$, we also have
  $\inln{n} : X \to A_n$ and $\inrn{n} : Y \to A_n$, such that
  $\inln{n+1} \circ \theta = \alpha_n \circ F \inl_{n}$, and similarly
  for $\inrn{n}$ and $\rho$. In other words: the inclusions preserve
  the approximate algebra structure.

  We define the objects $A_n$ inductively:
  \begin{itemize}
  \item $A_0 \ddefeq \coproduct{X}{Y}$ with $\inln{0} \ddefeq \ident{inl}$ and $\inrn{n}{0} \ddefeq \ident{inr}$
  \item
    $A_n+1 \ddefeq \pushout{\langle F \inln{n}, F \inrn{n}
      \rangle}{(\theta + \rho)}$
    with
    $\langle \inln{n+1}, \inrn{n+1} \rangle : \coproduct{X}{Y} \to
    A_{n+1}$
    and $\alpha_n : FA_n \to A_{n+1}$ being its two inclusion
    maps. (We have pushouts in $\Cc$ as it has binary coproducts and
    coequalisers.)
  \end{itemize}

  The corresponding pushout diagram for $A_{n+1}$ is the following:
  $$
  \xymatrix{
    \coproduct{FX}{FY} \ar[r]^{\theta + \rho} \ar[d]_{\langle F \inln{n} , F \inrn{n} \rangle} 
    &\coproduct{X}{Y} \ar[d]^{\langle \inln{n+1} , \inrn{n+1} \rangle} \\
    FA_n \ar[r]_{\alpha_n}
    &A_{n+1}
  }
  $$

  The morphisms $a_n : A_n \to A_{n+1}$ are also defined inductively:
  \begin{itemize}
  \item $a_0 \ddefeq \langle \inln{1}, \inrn{1} \rangle$, which
    satisfies by definition $a_0 \circ \inln{0} = \inln{1}$ and
    $a_0 \circ \inrn{0} = \inrn{1}$.
  \item $a_{n+1}$ is defined using the universal property of
    $A_{n+1}$:
    $$
    \xymatrix{
      \coproduct{FX}{FY} \ar[rr]^{\theta + \rho} \ar[d]^{\langle F \inln{n} , F \inrn{n} \rangle} 
      \ar@/_2pc/[dd]_{\langle F \inln{n+1} , F \inrn{n+1} \rangle}
      &&\coproduct{X}{Y} \ar[d]^{\langle \inln{n+1} , \inrn{n+1} \rangle} \ar@{=}[rr]
      &&\coproduct{X}{Y} \ar[dd]^{\langle \inln{n+2} , \inrn{n+2} \rangle} \\
      FA_n \ar[rr]_{\alpha_n} \ar[d]^{F a_n}
      &&A_{n+1} \ar[drr]_{a_{n+1}}
      \\
      FA_{n+1} \ar[rrrr]_{\alpha_{n+1}}
      &&&&A_{n+2}
    }
    $$
  \end{itemize}
  Note that we can assume that the left ``triangle'' commutes by
  induction hypothesis. As we have seen, it holds for $n = 0$. We then
  have to show that for the $a_{n+1}$ we define here, it again
  holds. By the computation rules of $a_{n+1}$ we have
  $a_{n+1} \circ \langle \inln{n+1} , \inrn{n+1} \rangle = \langle
  \inln{n+2} , \inrn{n+2} \rangle$.

  If we take the colimit of the cochain $(A,a)$, we get an object
  $A_{\omega}$ in $\Cc$ with constructors $c_n : A_n \to A_{\omega}$
  satisfying $c_n = c_{n+1} \circ a_n$, such that it satisfies the
  universal property of sequential colimits. Similarly, since $F$
  preserves sequential colimits, we also have that $FA_{\omega}$ with
  $Fc_n$ forms a colimiting cocone of the cochain $(FA,Fa)$.

  We now have to construct and check for several things on $A_{\omega}$:
  \begin{itemize}
  \item an algebra structure $F A_{\omega} \to A_{\omega}$
  \item inclusions $\inln{\omega} : X \to A_{\omega}$ and
    $\inrn{\omega}$, such that they are algebra morphisms
    $\theta \to \alpha_{\omega}$ and $\rho \to \alpha_{\omega}$
    respectively
  \item $(A_{\omega} , \alpha_{\omega})$ should have the universal
    property of being a coproduct of $(X,\theta)$ and $(Y,\rho)$
  \end{itemize}


  To construct the algebra structure on $A_{\omega}$, we define a
  cocone with carrier $A_{\omega}$ on the cochain $(FA, Fa)$ with a
  family of morphisms $d_n : FA_n \to A_{\omega}$ defined as the
  composite:
  $$
  \xymatrix{
    FA_n \ar[r]^{\alpha_n}
    &A_{n+1}
    \ar[r]^{c_{n+1}}
    &A_{\omega}
  }
  $$
  In order for this to be a cocone, we have to check whether
  $d_n = d_{n+1} \circ F a_n$.

  For $n = 0$, we have that it follows from the computation rule of
  $a_1$ and from the fact that $c_1$ and $c_2$ are constructors of the
  colimit $A_{\omega}$:
  $$
  c_1 \circ \alpha_0 = c_2 \circ a_1 \circ \alpha_0 = c_2 \circ \alpha_1 \circ Fa_0
  $$
  From this we get a unique morphism
  $\alpha_{\omega} : FA_{\omega} \to A_{\omega}$ with computation
  rules $\alpha_{\omega} \circ Fc_n = c_{n+1} \circ \alpha_n$.

  The inclusions maps $\inln{\omega}, \inrn{\omega}$ from $X$ and $Y$
  respectively into $A_{\omega}$ are defined as composing $\inln{0}$
  and $\inrn{0}$ with $c_0$. We then have to establish that these maps
  are in fact algebra morphisms. We will show this here for
  $\inln{\omega}$:
  %
  \begin{align*}
    \inln{\omega} \circ \theta &=& c_0 \circ \inln{0} \circ \theta \\
    &=& c_1 \circ a_0 \circ \theta \\
    &=& c_1 \circ \inln{1} \circ \theta \\
    &=& c_1 \circ \alpha_0 \circ F \inln{0} \\
    &=&\alpha_{\omega} \circ F c_0 \circ F \inln{0} \\
    &=&\alpha_{\omega} \circ F (c_0 \circ \inln{0}) \\
    &=&\alpha_{\omega} \circ F \inln{\omega}
  \end{align*}
  %
  By the same reasoning $\inr_{\omega}$ is an algebra morphism
  $\rho \to \alpha_{\omega}$.

  Finally we have to show that given an algebra $(Z,\zeta)$ with
  algebra morphisms $f : \theta \to \zeta$ and $g : \rho \to \zeta$,
  we get a unique algebra morphism $h : \alpha_{\omega} \to \zeta$
  satisfying $h \circ \inln{\omega} = f$ and $h \circ \inrn{\omega}$.

  Observe that $Z$ comes with a cocone for the cochain $(A,a)$ with
  $z_n : A_n \to Z$ defined inductively:
  \begin{itemize}
  \item $z_0  : A_0 \to Z$ defined as $\langle f , g \rangle$, as $A_0 \ddefeq \coproduct{X}{Y}$.
  \item $z_{n+1}$ is defined using the universal property of
    $A_{n+1}$:
    $$
    \xymatrix{
      \coproduct{FX}{FY} \ar[r]^{\theta + \rho} \ar[d]_{\langle F \inln{n} , F \inrn{n} \rangle} 
      &\coproduct{X}{Y} \ar[d]^{\langle \inln{n+1} , \inrn{n+1} \rangle} \ar@{=}[r]
      &\coproduct{X}{Y} \ar[dd]^{\langle f , g \rangle} \\
      FA_n \ar[r]_{\alpha_n} \ar[d]_{F z_n}
      &A_{n+1} \ar[dr]_{z_{n+1}}
      \\
      FZ \ar[rr]_{\zeta}
      &&Z
    }
    $$
  \end{itemize}

  In order for the definition of $z_{n+1}$ to make sense, we have to
  check whether outer square commutes. For $n = 0$, it commutes as $f$
  and $g$ are algebra morphisms. For the inductive step, it follows
  from the computation rule of $z_{n+1}$ and the fact that $f$ and $g$
  are algebra morphisms. As for the inductive step, we consider the
  following diagram:
  $$
  \xymatrix{
    \coproduct{FX}{FY} \ar[rr]^{\theta + \rho} \ar[d]^{\langle F \inln{n} , F \inrn{n} \rangle} 
    \ar@/_2pc/[dd]_{\langle F \inln{n+1} , F \inrn{n+1} \rangle}
    &&\coproduct{X}{Y} \ar[d]^{\langle \inln{n+1} , \inrn{n+1} \rangle} \ar@{=}[rr]
    &&\coproduct{X}{Y} \ar[dd]^{\langle \inln{n+2} , \inrn{n+2} \rangle} \ar@{=}[rr]
    &&\coproduct{X}{Y} \ar[ddd]^{\langle f , g \rangle}
    \\
    FA_n \ar[rr]_{\alpha_n} \ar[d]^{F a_n}
    &&A_{n+1} \ar[drr]_{a_{n+1}}
    \\
    FA_{n+1} \ar[rrrr]_{\alpha_{n+1}} \ar[d]_{F z_{n+1}}
    &&&&A_{n+2} \ar[drr]_{z_{n+2}}
    \\
    FZ \ar[rrrrrr]_{\zeta}
    &&&&&&Z
  }
  $$
  The triangle on the left commutes as before. This means that the
  outer square is the cocone on $Z$ that defines $z_{n+1}$. By the
  universal property of $A_{n+1}$ we then get that $z_{n+1}$ and
  $z_{n+1} \circ a_{n+1}$ are equal.
  
  We therefore get a unique morphism $z_{\omega} : A_{\omega} \to Z$
  satisfying $z_{\omega} \circ c_n = z_n$. Showing that this is an
  algebra morphism $\alpha_{\omega} \to \zeta$ can be done by showing
  that we have a cocone of the cochain $(FA,Fa)$ with carrier $Z$ and
  that both $\zeta \circ F z_{\omega}$ and
  $z_{\omega} \circ \alpha_{\omega}$ are cocone morphisms from
  $FA_{\omega}$ into $Z$, hence by the universal property of
  $FA_{\omega}$ they are equal.

  The cocone on $Z$ is defined with morphisms
  $\zeta \circ Fz_n : FA_n \to Z$. We have
  $\zeta \circ Fz_n = \zeta \circ Fz_{n+1} \circ Fa_n$, as $z_n$
  itself is a cocone on $(A,a)$. The fact that
  $\zeta \circ F z_{\omega}$ follows directly from the computation
  rules for $z_{\omega}$. Showing that $z_{n+1} \circ \alpha_n$ is a
  cocone morphism also follows directly from the computation rules of
  $z_{\omega}$ and $\alpha_{\omega}$.

  Lastly, we have to check whether composing $z_{\omega}$ with the
  inclusions from $X$ and $Y$ into $Z$ gives us back $f$ and $g$
  respectively. We can show this by performing the following
  computation:
  \begin{align*}
    z_{\omega} \circ \inln{\omega} &=& z_{\omega} \circ c_0 \circ \inln{0} \\
    &=&z_0 \circ \inln{0} \\
    &=&\langle f , g \rangle \circ \inl \\
    &=&f
  \end{align*}
  Showing that $z_{\omega} \circ \inrn{\omega} = g$ can be done
  analogously.
\end{proof}

\begin{proposition}
  The category $\algcat{F}$ has coequalisers.
\end{proposition}

\begin{proof}
  Let $(X,\theta),(Y,\rho) : | \algcat{F} |$ with
  $f, g : \theta \to \rho$ algebra morphisms. The coequaliser of $f$
  and $g$ can be defined using a construction similar to that of
  coproducts in \cref{f-alg-coproducts}. We again use the idea of
  constructing a sequence of approximations to the coequaliser, using
  pushouts to ensure that the inclusion maps are algebra morphisms. 

  We define the objects $A_n$ inductively:
  \begin{itemize}
  \item $A_0 \ddefeq \coeqty{f}{g}$
  \item $A_{n+1} \ddefeq \pushout{(F\beta_n \circ \langle F in_{f,g} \rangle)}{\langle in_{f,g} \circ \rho \rangle}$
  \end{itemize}
  \ie the following is a pushout diagram:
  $$
  \xymatrix{
    \coeqty{Ff}{Fg}
    \ar[rr]^{\langle in_{f,g} \circ \rho \rangle}
    \ar[d]_{\langle F in_{f,g} \rangle}
    &&\coeqty{f}{g}
    \ar[dd]^{\beta_{n+1}}
    \\
    F (\coeqty{f}{g})
    \ar[d]_{F\beta_n}
    \\
    FA_n 
    \ar[rr]_{\alpha_n}
    &&A_{n+1}
  }
  $$
  where $in_{f,g} : Y \to \coeqty{f}{g}$ is the constructor of
  $\coeqty{f}{g}$ and $\beta_0 \ddefeq \id_{\coeqty{f}{g}}$.

  We can define the morphisms $a_n : A_n \to A_{n+1}$ in the same way
  as before, using the universal property of pushouts. We can then
  proceed to define an algebra
  $\alpha_{\omega} : FA_{\omega} \to A_{\omega}$ on the colimit of
  $(A,a)$. This algebra has an inclusion from $(Y,\rho)$, which
  coequalises $f$ and $g$ and satisfies the universal property of
  coequalisers in $\algcat{F}$. The details for these constructions
  are all analogous to the proof of \cref{f-alg-coproducts}.
  
\end{proof}

\begin{proposition}
  The forgetful functor $U : \Func{\algcat{F}}{\Cc}$ has a left
  adjoint.
\end{proposition}

\begin{proof}
  This is a straightforward generalisation of
  \cref{free-monad-thm}. Since $F$ preserves sequential colimits, so
  does $\bar{F}_X$ for any $X : | \Cc |$, hence the initial algebra
  $F^* X$ exists.
\end{proof}

\subsubsection{Path constructors}
Suppose we have a category $\Cc : \Cat$ with an adjunction
$L \dashv U : \Func{\Cc}{\SET}$. To describe a path constructor
on $\Cc$, we need the following data:
\begin{itemize}
\item $F : \Func{\Cc}{\SET}$, describing the arguments of the constructor
\item $\ell, r : \Nat{F}{U}$, giving the end points of the equations
\end{itemize}

In the following we will assume that $\Cc$ is a category with
sequential colimits, binary coproducts and coequalisers and that $F$
is an endofunctor on $\Cc$ preserving sequential colimits.

Let us define the category $\Cc'$ as the full subcategory of $\Cc$
with objects $X : | \Cc |$ satisfying $\ell_X = r_X$.

\begin{proposition}
  $\Cc'$ has an initial object.
\end{proposition}

\begin{proof}
  Since we have $L \dashv U$, we have isomorphisms
  $$
  \phi_{X,Y} : \Cc(L X , Y) \to (X \to U Y)
  $$
  $\phi$ is natural in both $X$ and $Y$, hence we have natural
  transformations:
  $$
  \phi \circ \ell , \phi \circ r : \Nat{L \circ F}{\id_{\Cc}}
  $$
  It suffices to show that we have an initial object in the
  subcategory of $\Cc$ of objects $X : | \Cc |$ satisfying
  $\phi \circ \ell_X = \phi \circ r_X$.

  We define $X_\omega$ to be the colimit of the following cochain in $\Cc$:
  $$
  \xymatrix{
    &LF X_0
    \ar@<.5ex>[d]^{\phi \circ \ell_{X_0}}
    \ar@<-.5ex>[d]_{\phi \circ r_{X_0}}
    &LF X_1
    \ar@<.5ex>[d]^{\phi \circ \ell_{X_1}}
    \ar@<-.5ex>[d]_{\phi \circ r_{X_1}}
    &LF X_2 
    \ar@<.5ex>[d]^{\phi \circ \ell_{X_2}}
    \ar@<-.5ex>[d]_{\phi \circ r_{X_2}}
    &LF X_3
    \ar@<.5ex>[d]^{\phi \circ \ell_{X_3}}
    \ar@<-.5ex>[d]_{\phi \circ r_{X_3}}
    &LF X_4
    \ar@<.5ex>[d]^{\phi \circ \ell_{X_4}}
    \ar@<-.5ex>[d]_{\phi \circ r_{X_4}}
    \\
    \initobj \ar@{}[r]|{\ddefeq} 
    &X_0
    \ar[r]_{x_0}
    &X_1
    \ar[r]_{x_1}
    &X_2 
    \ar[r]_{x_2}
    &X_3
    \ar[r]_{x_3}
    &X_4
    \ar[r]_{x_4}
    &\hdots
    }
  $$
  That is, the $\omega$-cochain $(X,x)$ is defined as:
  \begin{align*}
    &X : (n : \natty) \to | \Cc | \\
    &X\ 0 \ddefeq \initobj \\
    &X\ (n+1) \ddefeq \coeqty{\phi \circ \ell_{X_n}}{\phi \circ r_{x_n}}
  \end{align*}
  with $x_{n}$ the constructor of corresponding coequaliser.

  We need to show that for $X_\omega$,
  $\phi \circ \ell_{X_\omega} = \phi \circ r_{X_\omega}$. This we will
  achieve by showing that $X_\omega$ has a cocone structure for the
  cochain $(LFX_n, LFx_n)$. Both $\phi \circ \ell_{X_\omega}$ and
  $\phi \circ r_{X_\omega}$ are cocone morphisms
  $LF X_\omega \to X_\omega$, which means that by the universal
  property of $LF X_\omega$ they must be equal.

  For $X_\omega$ we have:
  \begin{itemize}
  \item constructors $d_n : \Cc(X_n, X_\omega)$
  \item satisfying $d_n = d_{n+1} \circ x_n$
  \end{itemize}

  $F$ preserves sequential colimits and $L$ preserves all colimits as
  it is a left adjoint, hence $L \circ F$ preserves sequential
  colimits. We then have that $LFX_\omega$ is the colimit of the
  $\omega$-cochain $(LFX_n,x_n)$ and therefore have:
  \begin{itemize}
  \item constructors $LFd_n : \Cc(LFX_n, LFX_\omega)$
  \item satisfying $LFd_n = LFd_{n+1} \circ LFx_n)$
  \end{itemize}

  We define the $(LFX_n,LFx_n)$-cocone on $X_\omega$ with $z_n$ as the
  composite:
  $$
  \xymatrix{
    LFX_n
    \ar[r]^{\phi \circ \ell_n}
    &X_n
    \ar[r]^{d_n}
    &X_\omega
  }
  $$
  Note that it does not matter whether we use $l$ or $r$ here, as
  $d_n = x_n \circ d_{n+1}$ and $x_n$ is the coequaliser map, hence
  precomposing with $\phi \circ \ell$ or $\phi \circ r$ is going to yield
  the same result.

  We have to check that $z_n = z_{n+1} \circ LFx_n$, which holds as we
  have the following commutative diagram:
  $$
  \xymatrix{
    LFX_n
    \ar[r]^{\phi \circ \ell_n}
    \ar[d]_{LF x_n}
    &X_n
    \ar[r]^{d_n}
    \ar[d]^{x_n}
    &X_\omega
    \\
    LFX_{n+1}
    \ar[r]_{\phi \circ \ell_{n+1}}
    &X_{n+1}
    \ar[ur]_{d_{n+1}}
  }
  $$
  The left square holds by naturality of $\phi \circ \ell$, the right
  square holds as $X_\omega$ is a colimit with $d_n$ is constructors.
  
  Now we have constructed a $(LFX_n,LFx_n)$-cocone structure on
  $X_\omega$, we need to check whether $\phi \circ \ell_{X_\omega}$ and
  $\phi \circ r_{X_\omega}$ are indeed cocone morphisms. This amounts
  to checking whether the following commutes:
  $$
  \xymatrix{
    LFX_n
    \ar[r]^{LF d_n}
    \ar[d]_{\phi \circ \ell_{X_n}}
    &LFX_\omega
    \ar[d]^{\phi \circ \ell_{X_\omega}}
    \\
    X_n
    \ar[r]_{d_n}
    &X_\omega
  }
  $$

  This square commutes by naturality of $\phi \circ \ell$. By the same
  reasoning $\phi \circ r_{X_\omega}$ is a cocone morphism, hence by
  the universal property of $LFX_\omega$ we get that
  $\phi \circ \ell_{X_\omega} = \phi \circ r_{X_\omega}$.
\end{proof}

\begin{proposition}
  The inclusion/forgetful functor $U' : \Func{\Cc'}{\Cc}$ has a left
  adjoint.
\end{proposition}

\begin{proof}
  We can take the proof of initiality and replace the object $X_0$
  with any $X : | \Cc |$. We define the left adjoint
  $L' : \Func{\Cc}{\Cc'}$ with $L' X$ being the colimit of this
  sequence.
\end{proof}

\begin{proposition}
  $\Cc'$ has coproducts and coequalisers.
\end{proposition}

\begin{proof}
  We claim that the left adjoint $L'$ to the inclusion functor of the
  subcategory $\Cc'$ into $\Cc$ gives us coproducts and coequalisers. 

  Let $X, Y : | \Cc |$ with $\theta : \ell_X = \rho_X$ and
  $\rho : \ell_Y = \rho_Y$. By assumption, $\Cc$ has coproducts. The
  object $L' (\coproduct{X}{Y})$ is the coproduct of $(X,\theta)$ and $(Y,\rho)$,
  as we have for any $(Z,\zeta) : | \Cc' |$:
  $$
  \Cc'(L'(X+Y),(Z,\zeta)) = \Cc(X+Y,Z) = \Cc(X,Z) \times \Cc(Y,Z) = \Cc'((X,\theta),(Z,\zeta)) \times \Cc'((Y,\rho),(Z,\zeta))
  $$

  Similarly for coequalisers, suppose that we again have
  $(X,\theta), (Y,\rho) : | \Cc' |$ with
  $f, g : \Cc'((X,\theta),(Y,\rho))$, so we really just have
  $f, g : \Cc(X,Y)$, then taking the coequaliser to be
  $L' (\coeqty{f}{g})$, we can calculate for any $(Z,\zeta) : | \Cc' |$:
  $$
  \Cc'(L'(\coeqty{f}{g}),(Z,\zeta)) = \Cc(\coeqty{f}{g}, Z) = (h : \Cc(Y,Z)) \times (h \circ f = h \circ g)
  $$
  which again by $\Cc'$ being a full subcategory means that
  $L'(\coeqty{f}{g})$ is indeed a coequaliser in $\Cc'$ of $f$ and $g$.
\end{proof}

\begin{proposition}
  $\Cc'$ has sequential colimits.
\end{proposition}

\begin{proof}
  Suppose we have a cochain in $\Cc'$, \ie we have:
  \begin{itemize}
  \item $X : \natty \to | \Cc |$
  \item $\theta : (n : \natty) \to \ell_{X_n} = r_{X_n}$
  \item $x : (n : \natty) \to \Cc(X_n,X_{n+1})$
  \end{itemize}

  By the assumptions on $\Cc$, we the colimit of the cochain $(X,x)$ in $\Cc$: we have:
  \begin{itemize}
  \item $X_{\omega} : | \Cc |$
  \item $c : (n : \natty) \to \Cc(X_n, X_{\omega})$
  \item $g : c_n = c_{n+1} \circ x_n$
  \end{itemize}
  Similarly, as $F$ preserves sequential colimits $F X_{\omega}$ with
  $Fc$ is a colimiting cocone of the cochain $(FX, Fx)$.

  Note that the natural transformation $\ell$ gives rise to the
  following cocone of the cochain $(FX,Fx)$:
  \begin{itemize}
  \item $U X_{\omega} : | \Cc |$
  \item $d : \Cc(FX_n , UX_{\omega})$ defined as
    $U c_n \circ \ell_{X_n}$
    \item $h : d_n = d_{n+1} \circ Fx_n$
  \end{itemize}
  The equality $h$ holds by the considering the following diagram:
  $$
  \xymatrix{
    FX_n
    \ar[r]^{\ell_{X_n}}
    \ar[d]_{F x_n}
    &UX_n
    \ar[d]^{U x_n}
    \ar[r]^{U c_n}
    &UX_{\omega}
    \\
    FX_{n+1}
    \ar[r]_{\ell_{X_{n+1}}}
    &UX_{n+1}
    \ar[ru]_{U c_{n+1}}
  }
  $$
  The left square holds by naturality of $\ell$ and the right triangle
  commutes due to the fact that $X_{\omega}$ is the colimit of the
  cochain $(X,x)$.

  We claim that both $l_{X_{\omega}}$ and $r_{X_{\omega}}$ are cocone
  morphisms from colimiting $FX_{\omega}$ with $Fc$ into $UX_{\omega}$
  with $Uc$, as we have
  $Uc_n \circ \ell_{X_n} = \ell_{X_{\omega}} \circ Fc_n$ by
  naturality. Since $\ell_{X_n} = r_{X_n}$ for every $n : \natty$,
  $l_{X_{\omega}}$ and $r_{X_{\omega}}$ are cocone morphisms from the
  same cocone, hence $l_{X_{\omega}} = r_{X_{\omega}}$. This gives us
  that $X_{\omega}$ is in the subcategory $\Cc'$. Since it is a full
  subcategory, we also get the universality from $\Cc$.
\end{proof}

\section{Related work}

In this chapter we have shown for some of the categories of algebras
that they are finitely cocomplete. Our goal was to use these colimits
to construct left adjoints. There are several different approaches to
this problem.

The obvious choice would be to look at the Freyd's adjoint functor
theorem. This theorem gives us a left adjoint for a functor, given
that its domain is complete, that the functor is continuous and that
the solution set condition is satisfied. In
\cref{limits-in-categories-of-algebras}, we have (almost) shown that
the categories we are working with are finitely complete and that the
forgetful functors are continuous. Extending this to completeness
means that we have to show that they have terminal objects and
generalise binary products to arbitrary ones. More difficult would be
to show that the solution set condition is satisfied.

As for showing cocompleteness of categories of monad algebras, there
are several treatments of colimits of monad algebras
\cite{Linton1969,Barr1985}. The main result in \cite{Linton1969} is
that, given that $\Cc$ is cocomplete, the category of monad algebras
$\monalgcat{M}$ for a monad $M : \Func{\Cc}{\Cc}$ is cocomplete if and
only if it has reflexive coequalisers. $\monalgcat{M}$ has reflexive
coequalisers if $M$ preserves them.
